<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Icebase</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- <script src="./index.js"></script> -->
  </head>
  <body>
    <div id="app"></div>
    <!-- <script type="module" src="/index.js"></script>  -->
    <div class="container my-5">
      <div class="row my-4">
      <input type="text" placeholder="name" class="text-center mx-3 border-1 rounded-md drop-shadow-md" id="name">
      <input type="text" placeholder="username" class="text-center mx-3 border-1 rounded-md drop-shadow-md" id="username">
      <input type="text" placeholder="email" class="text-center mx-3 border-1 rounded-md drop-shadow-md" id="email">
    </div>
      <div class="buttons text-center">
      <button id="submit" class="mx-4 p-2 rounded-md border-2 drop-shadow-md">send</button>
      <button id="get" class="mx-4 p-2 border-2 rounded-md drop-shadow-md">get</button>
      <button id="update" class="mx-4 p-2 rounded-md border-2 drop-shadow-md">update</button>
      <button id="delete" class="mx-4 p-2 border-2 rounded-md drop-shadow-md">delete</button>
      </div>
    
      <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.14.0/firebase-app.js";
        // TODO: Add SDKs for Firebase products that you want to use
        // https://firebase.google.com/docs/web/setup#available-libraries
        import firebase from 'firebase/compat/app';
        import 'firebase/compat/database';
        import { getDatabase } from "https://www.gstatic.com/firebasejs/9.14.0/firebase-database.js"

        // Your web app's Firebase configuration
          const firebaseConfig = {
          apiKey: "AIzaSyD9m74Ngn7FI82IM2YdXPGljvGbQSMvLUY",
          authDomain: "icebase-31674.firebaseapp.com",
          databaseURL: "https://icebase-31674-default-rtdb.firebaseio.com",
          projectId: "icebase-31674",
          storageBucket: "icebase-31674.appspot.com",
          messagingSenderId: "551544382823",
          appId: "1:551544382823:web:1a5c13dee46d1ad3b13bc2"
        };
        
        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        firebase.initializeApp(firebaseConfig);
        const database = getDatabase(app);
        

        
        // Form CRUD

        
      document.querySelector('#submit').addEventListener('click', () => { 
        let name = document.getElementById('name').value;
        let email = document.getElementById('email').value;
        let username = document.getElementById('username').value;
        firebase.database().ref('user-info/' + username).set({
          name: name,
          username: username,
          email:  email
        })
      })
        

        document.querySelector('#get').addEventListener('click', () => { 
        let name = document.getElementById('name').value;
        let email = document.getElementById('email').value;
        let username = document.getElementById('username').value;
        let user_ref = firebase.database().ref('user-info/' + username)
          user_ref.on('value', function(snapshot) {
            let data = snapshot.val()
            console.log(data.email)
          })
      })


      document.querySelector('#update').addEventListener('click', () => { 
        let name = document.getElementById('name').value;
        let email = document.getElementById('email').value;
        let username = document.getElementById('username').value;
        let updates = {
          name: name,
          username: username,
          email:  email
        }         
         firebase.database().ref('user-info/' + username).update(updates)
        })
      

      document.querySelector('#delete').addEventListener('click', () => { 
        let username = document.getElementById('username').value;
         firebase.database().ref('user-info/' + username).remove()
        })

      </script>
  </div>
  </body>
</html>
