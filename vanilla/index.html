<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Icebase</title>
    <!-- Compiled and minified CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">

    <!-- Compiled and minified JavaScript -->

            
    <!-- <script src="./index.js"></script> -->
  </head>
  <body>
    <nav>
      <div class="nav-wrapper">
        <a href="#" class="brand-logo" style="padding-left:25px;">Icebase</a>
        <ul id="nav-mobile" class="right hide-on-med-and-down">
          <li><a href="sass.html">One</a></li>
          <li><a href="badges.html">Two</a></li>
          <li><a href="collapsible.html">Three</a></li>
        </ul>
      </div>
    </nav>
    <!-- <script type="module" src="/index.js"></script>  -->
  <main>
    <div class="container" style="position: absolute; top: 25%; left: 25%; width: 50%">
      <div class="row my-4">
      <input type="text" placeholder="name" class="text-center mx-3 border-1 rounded-md drop-shadow-md" id="name">
      <input type="text" placeholder="username" class="text-center mx-3 border-1 rounded-md drop-shadow-md" id="username">
      <input type="text" placeholder="email" class="text-center mx-3 border-1 rounded-md drop-shadow-md" id="email">
    </div>
      <div class="buttons text-center">
      <button id="submit" class="waves-effect waves-light btn">send</button>
      <button id="get" class="waves-effect waves-light btn">get</button>
      <button id="update" class="waves-effect waves-light blue light btn">update</button>
      <button id="delete" class="waves-effect waves-light red light btn">delete</button>
      </div>
    </main>
      <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.14.0/firebase-app.js";
        // TODO: Add SDKs for Firebase products that you want to use
        // https://firebase.google.com/docs/web/setup#available-libraries
        import firebase from 'firebase/compat/app';
        import 'firebase/compat/database';
        import { getDatabase } from "https://www.gstatic.com/firebasejs/9.14.0/firebase-database.js"

        // Your web app's Firebase configuration
          const firebaseConfig = {
          apiKey: "AIzaSyD9m74Ngn7FI82IM2YdXPGljvGbQSMvLUY",
          authDomain: "icebase-31674.firebaseapp.com",
          databaseURL: "https://icebase-31674-default-rtdb.firebaseio.com",
          projectId: "icebase-31674",
          storageBucket: "icebase-31674.appspot.com",
          messagingSenderId: "551544382823",
          appId: "1:551544382823:web:1a5c13dee46d1ad3b13bc2"
        };
        
        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        firebase.initializeApp(firebaseConfig);
        const database = getDatabase(app);
        

        
        // Form CRUD

        
      document.querySelector('#submit').addEventListener('click', () => { 
        let name = document.getElementById('name').value;
        let email = document.getElementById('email').value;
        let username = document.getElementById('username').value;
        firebase.database().ref('user-info/' + username).set({
          name: name,
          username: username,
          email:  email
        })
      })
        

        document.querySelector('#get').addEventListener('click', () => { 
        let name = document.getElementById('name').value;
        let email = document.getElementById('email').value;
        let username = document.getElementById('username').value;
        let user_ref = firebase.database().ref('user-info/' + username)
          user_ref.on('value', function(snapshot) {
            let data = snapshot.val()
            console.log(data.email)
          })
      })


      document.querySelector('#update').addEventListener('click', () => { 
        let name = document.getElementById('name').value;
        let email = document.getElementById('email').value;
        let username = document.getElementById('username').value;
        let updates = {
          name: name,
          username: username,
          email:  email
        }         
         firebase.database().ref('user-info/' + username).update(updates)
        })
      

      document.querySelector('#delete').addEventListener('click', () => { 
        let username = document.getElementById('username').value;
         firebase.database().ref('user-info/' + username).remove()
        })

      </script>
    </div>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
  </body>
</html>
